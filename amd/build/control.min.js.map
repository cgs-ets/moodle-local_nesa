{"version":3,"file":"control.min.js","sources":["../src/control.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle. If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript controller for adding Studies Code column to grading tables.\n *\n * @module     local_nesa/control\n * @copyright  2025 Veronica Bermegui\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * Add Studies Code column to the user grades table (gradebook).\n *\n * @param {Object} nesanumbers - Object mapping user IDs to their NESA data\n * @param {string} coursetype - Type of course (IB or HSC)\n */\nconst setStudiesCodeForUserGradesTable = (nesanumbers, coursetype) => {\n    const table = document.getElementById('user-grades');\n\n    if (!table) {\n        return;\n    }\n\n    const headingRow = table.querySelector('tr.heading');\n    if (!headingRow) {\n        return;\n    }\n\n    const useremailColumn = headingRow.querySelector('th.userfield.useremail');\n    if (!useremailColumn) {\n        return;\n    }\n\n    // Get the column index of the useremail column\n    const emailIndex = Array.from(headingRow.children).indexOf(useremailColumn);\n\n    // Create NESA column header\n    const nesaHeader = document.createElement('th');\n    nesaHeader.className = `userfield studiescode cell c${emailIndex}`;\n    nesaHeader.setAttribute('data-col', 'studiescode');\n    nesaHeader.setAttribute('scope', 'col');\n\n    // Create span with data-collapse content\n    const spanElement = document.createElement('span');\n    spanElement.setAttribute('data-collapse', 'content');\n    console.log('Course type in setStudiesCodeForUserGradesTable:');\n    console.log(typeof coursetype);\n    let isIB = false;\n    let isHSC = false;\n    if (coursetype === 'IB') {\n        spanElement.textContent = 'IB Personal Code';\n        isIB = true;\n    } else {\n        spanElement.textContent = 'Studies Code';\n        isHSC = true;\n    }\n\n    // Create button element\n    const buttonElement = document.createElement('button');\n    buttonElement.className = 'nesa-number btn btn-link btn-icon icon-size-3 cellmenubtn';\n    buttonElement.setAttribute('type', 'button');\n    buttonElement.setAttribute('data-toggle', 'dropdown');\n    buttonElement.setAttribute('aria-haspopup', 'true');\n    buttonElement.setAttribute('aria-expanded', 'false');\n    buttonElement.setAttribute('data-type', 'studiescode');\n    buttonElement.setAttribute('data-id', 'studiescode');\n\n    nesaHeader.appendChild(spanElement);\n    nesaHeader.appendChild(buttonElement);\n\n    // Insert the studies code column header before useremail\n    useremailColumn.parentNode.insertBefore(nesaHeader, useremailColumn);\n\n    // Add the studies code column to each row in the tbody\n    const tbodyRows = table.querySelectorAll('tbody tr');\n    tbodyRows.forEach((row) => {\n        const userid = row.getAttribute('data-uid');\n\n        if(isHSC) {\n            var studiescode = nesanumbers[userid]?.studies_code !== undefined\n                ? nesanumbers[userid].studies_code\n                : 'N/A';\n        } else if(isIB) {\n            var studiescode = nesanumbers[userid]?.ib_code !== undefined\n                ? nesanumbers[userid].ib_code\n                : 'N/A';\n        }\n\n\n        // Create the new studies code cell with a div inside.\n        const nesaCell = document.createElement('td');\n        nesaCell.className = `userfield studiescode cell c${emailIndex}`;\n        nesaCell.setAttribute('data-col', 'studiescode');\n\n        const divElement = document.createElement('div');\n        divElement.setAttribute('data-collapse', 'content');\n        divElement.textContent = studiescode;\n\n        nesaCell.appendChild(divElement);\n\n        // Find the useremail cell and insert the studies code cell before it\n        const useremailCell = row.querySelector('td.userfield.useremail');\n        if (useremailCell) {\n            useremailCell.parentNode.insertBefore(nesaCell, useremailCell);\n        }\n    });\n\n    // Adjust the class of the useremail column in the header (shift to next column)\n    headingRow.querySelectorAll('th.userfield.useremail').forEach((th) => {\n        const newClassNumber = emailIndex + 1;\n        th.classList.remove(`c${emailIndex}`);\n        th.classList.add(`c${newClassNumber}`);\n    });\n\n    // Adjust the class for the useremail column cells (body rows)\n    table.querySelectorAll('tbody td.userfield.useremail').forEach((td) => {\n        const newClassNumber = emailIndex + 1;\n        td.classList.remove(`c${emailIndex}`);\n        td.classList.add(`c${newClassNumber}`);\n    });\n\n    // Shift classes for all columns after useremail in the heading\n    const allHeaders = headingRow.querySelectorAll('th');\n    allHeaders.forEach((th, index) => {\n        if (index > emailIndex) {\n            const newClassNumber = index + 1;\n            th.classList.remove(`c${index + 1}`);\n            th.classList.add(`c${newClassNumber}`);\n        }\n    });\n\n    // Shift classes for all columns after useremail in the body rows\n    table.querySelectorAll('tbody td').forEach((td) => {\n        const currentColumnIndex = Array.from(td.parentNode.children).indexOf(td);\n        if (currentColumnIndex > emailIndex) {\n            const newClassNumber = currentColumnIndex + 1;\n            td.classList.remove(`c${currentColumnIndex + 1}`);\n            td.classList.add(`c${newClassNumber}`);\n        }\n    });\n\n    // Change the colspan to adapt to the number of userfield columns\n    const firstTr = table.querySelector('tr');\n    const topLeftCell = firstTr?.querySelector('th.cell.topleft');\n    const userfieldCount = headingRow.querySelectorAll('th.userfield').length;\n\n    if (topLeftCell) {\n        // +1 because the firstname/lastname doesn't have the userfield class\n        topLeftCell.setAttribute('colspan', userfieldCount + 1);\n    }\n\n    // Update the colspan for rows after the last userrow\n    const userRows = table.querySelectorAll('tr.userrow');\n    const lastUserRow = userRows[userRows.length - 1];\n\n    if (lastUserRow) {\n        let nextSibling = lastUserRow.nextElementSibling;\n        while (nextSibling) {\n            const thElement = nextSibling.querySelector('th');\n            if (thElement) {\n                thElement.setAttribute('colspan', userfieldCount + 1);\n            }\n            nextSibling = nextSibling.nextElementSibling;\n        }\n    }\n};\n\n// Track current sort state for Studies Code column\nlet studiesCodeSortAsc = true;\n\n/**\n * Sort the submissions table by Studies Code column.\n *\n * @param {HTMLTableElement} table - The table element\n */\nconst sortTableByStudiesCode = (table) => {\n    const tbody = table.querySelector('tbody');\n    if (!tbody) {\n        return;\n    }\n\n    // Only select direct children tr of tbody, not nested tr inside file submission tables\n    const allRows = Array.from(tbody.querySelectorAll(':scope > tr'));\n\n    // Sort rows by the Studies Code value\n    allRows.sort((a, b) => {\n        const cellA = a.querySelector('td.studiescode');\n        const cellB = b.querySelector('td.studiescode');\n\n        const valueA = cellA ? cellA.textContent.trim() : '';\n        const valueB = cellB ? cellB.textContent.trim() : '';\n\n        // Handle N/A values - push them to the end\n        if (valueA === 'N/A' && valueB !== 'N/A') {\n            return 1;\n        }\n        if (valueB === 'N/A' && valueA !== 'N/A') {\n            return -1;\n        }\n\n        // Compare alphanumerically\n        const comparison = valueA.localeCompare(valueB, undefined, {numeric: true, sensitivity: 'base'});\n        return studiesCodeSortAsc ? comparison : -comparison;\n    });\n\n    // Re-append rows in sorted order\n    allRows.forEach((row) => {\n        tbody.appendChild(row);\n    });\n\n    // Toggle sort direction for next click\n    studiesCodeSortAsc = !studiesCodeSortAsc;\n};\n\n/**\n * Check if the current page is showing all results (no pagination).\n *\n * @returns {boolean} True if showing all results\n */\nconst isShowingAll = () => {\n    const url = new URL(window.location.href);\n    const perpage = url.searchParams.get('perpage');\n    // perpage=-1 means \"show all\" in Moodle\n    return perpage === '-1';\n};\n\n/**\n * Redirect to show all results with a marker to sort after load.\n */\nconst redirectToShowAllAndSort = () => {\n    const url = new URL(window.location.href);\n    url.searchParams.set('perpage', '-1');\n    // Use sessionStorage to preserve sort intent across redirect (more reliable than URL params)\n    sessionStorage.setItem('sortbystudiescode', '1');\n    window.location.href = url.toString();\n};\n\n/**\n * Add Studies Code column to the submissions table (mod/assign grading view).\n *\n * @param {Object} nesanumbers - Object mapping user IDs to their NESA data\n * @param {string} coursetype - Type of course (IB or HSC)\n */\nconst setStudiesCodeForSubmissionsTable = (nesanumbers, coursetype) => {\n    const table = document.getElementById('submissions');\n\n    if (!table) {\n        return;\n    }\n\n    // Find the header row - it's in thead\n    const thead = table.querySelector('thead');\n    if (!thead) {\n        return;\n    }\n\n    const headingRow = thead.querySelector('tr');\n    if (!headingRow) {\n        return;\n    }\n\n    // Find the email column header (class contains 'email' and 'header')\n    const useremailColumn = headingRow.querySelector('th.email');\n    if (!useremailColumn) {\n        return;\n    }\n\n    // Get the column index\n    const emailIndex = Array.from(useremailColumn.parentNode.children).indexOf(useremailColumn);\n\n    // Create Studies Code column header with sort functionality\n    const studiesCodeHeader = document.createElement('th');\n    studiesCodeHeader.className = `header c${emailIndex} studiescode`;\n    studiesCodeHeader.setAttribute('scope', 'col');\n    studiesCodeHeader.style.cursor = 'pointer';\n\n    // Create clickable link for sorting\n    const sortLink = document.createElement('a');\n    sortLink.href = '#';\n    let isIB = false;\n    let isHSC = false;\n    if (coursetype === 'IB') {\n        sortLink.textContent = 'IB Personal Code';\n        isIB = true;\n    } else {\n        sortLink.textContent = 'Studies Code';\n        isHSC = true;\n    }\n    sortLink.title = 'Click to sort by Studies Code';\n    sortLink.style.textDecoration = 'none';\n    sortLink.style.color = 'inherit';\n\n    // Add sort icon\n    const sortIcon = document.createElement('span');\n    sortIcon.className = 'sort-icon';\n    sortIcon.innerHTML = ' ↕';\n    sortLink.appendChild(sortIcon);\n\n    sortLink.addEventListener('click', (e) => {\n        e.preventDefault();\n\n        if (!isShowingAll()) {\n            // Need to show all first, then sort\n            redirectToShowAllAndSort();\n        } else {\n            // Already showing all, sort directly\n            sortTableByStudiesCode(table);\n            // Update sort icon\n            sortIcon.innerHTML = studiesCodeSortAsc ? ' ↓' : ' ↑';\n        }\n    });\n\n    studiesCodeHeader.appendChild(sortLink);\n\n    // Insert the Studies Code column header before email\n    useremailColumn.parentNode.insertBefore(studiesCodeHeader, useremailColumn);\n\n    // Add the Studies Code column to each row in the tbody\n    const tbodyRows = table.querySelectorAll('tbody tr');\n\n    tbodyRows.forEach((row) => {\n        // Extract userid from row class (format: \"user123\")\n        const rowClasses = row.className.split(' ');\n        const userClass = rowClasses.find(cls => cls.startsWith('user') && cls !== 'userrow');\n        const userid = userClass ? userClass.replace('user', '') : null;\n\n        if(isIB) {\n            var studiescode = userid && nesanumbers[userid]?.ib_code\n                ? nesanumbers[userid].ib_code\n                : 'N/A';\n            \n        } else if(isHSC) {\n            var studiescode = userid && nesanumbers[userid]?.studies_code\n                ? nesanumbers[userid].studies_code\n                : 'N/A';\n        }\n\n        // Create the new Studies Code cell\n        const studiesCodeCell = document.createElement('td');\n        studiesCodeCell.className = `cell c${emailIndex} studiescode`;\n        studiesCodeCell.textContent = studiescode;\n\n        // Find the email cell and insert the Studies Code cell before it\n        const useremailCell = row.querySelector('td.email');\n        if (useremailCell) {\n            useremailCell.parentNode.insertBefore(studiesCodeCell, useremailCell);\n        }\n    });\n\n    // Adjust column classes for email and subsequent columns in header\n    const allHeaders = headingRow.querySelectorAll('th');\n    allHeaders.forEach((th, index) => {\n        if (index >= emailIndex && index !== emailIndex) {\n            // This is email or after - shift the class number\n            const oldClassMatch = th.className.match(/c(\\d+)/);\n            if (oldClassMatch) {\n                const oldNum = parseInt(oldClassMatch[1], 10);\n                th.classList.remove(`c${oldNum}`);\n                th.classList.add(`c${oldNum + 1}`);\n            }\n        }\n    });\n\n    // Adjust column classes for email and subsequent columns in body\n    tbodyRows.forEach((row) => {\n        const cells = row.querySelectorAll('td');\n        cells.forEach((td, index) => {\n            if (index >= emailIndex && index !== emailIndex) {\n                const oldClassMatch = td.className.match(/c(\\d+)/);\n                if (oldClassMatch) {\n                    const oldNum = parseInt(oldClassMatch[1], 10);\n                    td.classList.remove(`c${oldNum}`);\n                    td.classList.add(`c${oldNum + 1}`);\n                }\n            }\n        });\n    });\n\n    // Check if we should auto-sort (redirected from pagination)\n    if (sessionStorage.getItem('sortbystudiescode') === '1') {\n        // Remove the marker from sessionStorage (clean up)\n        sessionStorage.removeItem('sortbystudiescode');\n\n        // Trigger sort\n        sortTableByStudiesCode(table);\n        sortIcon.innerHTML = studiesCodeSortAsc ? ' ↓' : ' ↑';\n    }\n};\n\n/**\n * Initialize the module.\n *\n * @param {string} nesanumbers - JSON string of NESA numbers data\n * @param {string} coursetype - Type of course (IB or HSC)\n */\nexport const init = (nesanumbers, coursetype) => {\n    const parsedNesaNumbers = JSON.parse(nesanumbers);\n\n    console.log('Initializing NESA control module with data:', parsedNesaNumbers, 'and course type:', coursetype);\n    if (document.readyState === 'loading') {\n        document.addEventListener('DOMContentLoaded', () => {\n            setStudiesCodeForUserGradesTable(parsedNesaNumbers, coursetype);\n            setStudiesCodeForSubmissionsTable(parsedNesaNumbers, coursetype);\n        });\n    } else {\n        setStudiesCodeForUserGradesTable(parsedNesaNumbers, coursetype);\n        setStudiesCodeForSubmissionsTable(parsedNesaNumbers, coursetype);\n    }\n};\n"],"names":["setStudiesCodeForUserGradesTable","nesanumbers","coursetype","table","document","getElementById","headingRow","querySelector","useremailColumn","emailIndex","Array","from","children","indexOf","nesaHeader","createElement","className","setAttribute","spanElement","console","log","isIB","isHSC","textContent","buttonElement","appendChild","parentNode","insertBefore","querySelectorAll","forEach","row","userid","getAttribute","studiescode","undefined","studies_code","ib_code","nesaCell","divElement","useremailCell","th","newClassNumber","classList","remove","add","td","index","currentColumnIndex","firstTr","topLeftCell","userfieldCount","length","userRows","lastUserRow","nextSibling","nextElementSibling","thElement","studiesCodeSortAsc","sortTableByStudiesCode","tbody","allRows","sort","a","b","cellA","cellB","valueA","trim","valueB","comparison","localeCompare","numeric","sensitivity","setStudiesCodeForSubmissionsTable","thead","studiesCodeHeader","style","cursor","sortLink","href","title","textDecoration","color","sortIcon","innerHTML","addEventListener","e","preventDefault","URL","window","location","searchParams","get","url","set","sessionStorage","setItem","toString","redirectToShowAllAndSort","tbodyRows","userClass","split","find","cls","startsWith","replace","_nesanumbers$userid3","_nesanumbers$userid4","studiesCodeCell","oldClassMatch","match","oldNum","parseInt","getItem","removeItem","parsedNesaNumbers","JSON","parse","readyState"],"mappings":"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"}